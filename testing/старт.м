дія не_1біт(вхід)
  якщо вхід == "0"
    вернути "1"
  інакше
  якщо вхід == "1"
    вернути "0"
  кінець
  кінець
кінець

дія або_1біт(вхід1,вхід2)
  якщо вхід1 == "1" або вхід2 == "1"
    вернути "1"
  інакше
    вернути "0"
  кінець
кінець

дія і_1біт(вхід1,вхід2)
  якщо вхід1 == "1" і вхід2 == "1"
    вернути "1"
  інакше
    вернути "0"
  кінець
кінець

дія к_1біт(вхід1,вхід2)
  якщо вхід1 == "0" і вхід2 == "0"
    вернути "0"
  кінець
  якщо вхід1 == "1" і вхід2 == "0"
    вернути "1"
  кінець
  якщо вхід1 == "0" і вхід2 == "1"
    вернути "1"
  кінець
  якщо вхід1 == "1" і вхід2 == "1"
    вернути "0"
  кінець
  вернути "0"
кінець

дія додати_1біт_бк(вхід1,вхід2)
  рез = к_1біт(вхід1,вхід2)
  к = і_1біт(вхід1,вхід2)
  рез = рез + к
  вернути рез
кінець

дія б_д(вхід)
  рез = 0
  д_в = вхід.довжина - 1
  ін = д_в
  перебрати 0..д_в як х
    якщо вхід[ін] == "1"
      рез = рез + 2**х
    кінець
    ін = ін - 1
  кінець
  вернути рез
кінець

дія рб(вхід)
  р1 = вхід[0] + вхід[1] + вхід[2] + вхід[3]
  р2 = вхід[4] + вхід[5] + вхід[6] + вхід[7]
  вернути [р1,р2]
кінець

дія додати_1біт_зк(вхід1,вхід2,кв)
  р1 = к_1біт(вхід1,вхід2)
  к1 = і_1біт(вхід1,вхід2)
  ре = к_1біт(р1,кв)
  к = і_1біт(р1,кв)
  к = або_1біт(к1,к)
  ре = ре + к
  вернути ре
кінець

дія декодер_2біт_4біт(вхід)
  вх1 = вхід[0]
  вх2 = вхід[1]
  нв1 = не_1біт(вх1)
  нв2 = не_1біт(вх2)
  ви1 = і_1біт(нв1,нв2)
  ви2 = і_1біт(нв1,вх2)
  ви3 = і_1біт(нв2,вх1)
  ви4 = і_1біт(вх1,вх2)
  рез = (ви1 + ви2 + ви3 + ви4)
  вернути рез
кінець

дія лм_1біт(вхід,дв)
  вхід1 = вхід[0]
  вхід2 = вхід[1]
  вн = не_1біт(вхід1)
  ва = або_1біт(вхід1,вхід2)
  ві = і_1біт(вхід1,вхід2)
  вн = і_1біт(вн,дв[0])
  ва = і_1біт(ва,дв[1])
  ві = і_1біт(ві,дв[2])
  р1 = або_1біт(вн,ва)
  р1 = або_1біт(р1,ві)
  вернути р1
кінець

дія алм_1біт_бк(вхід)
  дви = декодер_2біт_4біт(вхід[0]+вхід[1])
  лмв = лм_1біт(вхід[2]+вхід[3],дви)
  дв = додати_1біт_бк(вхід[2],вхід[3])
  двв = і_1біт(дв[0],дви[3])
  к = і_1біт(дв[1],дви[3])
  рез = або_1біт(лмв,двв)
  рез = рез + к
  вернути рез
кінець

дія алм_1біт_зк(вхід,кв)
  дви = декодер_2біт_4біт(вхід[0]+вхід[1])
  лмв = лм_1біт(вхід[2]+вхід[3],дви)
  дв = додати_1біт_зк(вхід[2],вхід[3],кв)
  двв = і_1біт(дв[0],дви[3])
  к = і_1біт(дв[1],дви[3])
  рез = або_1біт(лмв,двв)
  рез = рез + к
  вернути рез
кінець

дія алм_8біт(вхід1,вхід2,вд)
  ви8 = алм_1біт_бк(вд+вхід1[7]+вхід2[7])
  к = ви8[1]
  ви7 = алм_1біт_зк(вд+вхід1[6]+вхід2[6],к)
  к = ви7[1]
  ви6 = алм_1біт_зк(вд+вхід1[5]+вхід2[5],к)
  к = ви6[1]
  ви5 = алм_1біт_зк(вд+вхід1[4]+вхід2[4],к)
  к = ви5[1]
  ви4 = алм_1біт_зк(вд+вхід1[3]+вхід2[3],к)
  к = ви4[1]
  ви3 = алм_1біт_зк(вд+вхід1[2]+вхід2[2],к)
  к = ви3[1]
  ви2 = алм_1біт_зк(вд+вхід1[1]+вхід2[1],к)
  к = ви2[1]
  ви1 = алм_1біт_зк(вд+вхід1[0]+вхід2[0],к)
  к = ви1[1]
  рез = (ви1[0] + ви2[0] + ви3[0] + ви4[0] + ви5[0] + ви6[0] + ви7[0])
  рез = рез + ви8[0]
  вернути рез
кінець

структура ЦП
  ін текст
  п список
  р список
кінець

дія ЦП.створити()
  я.ін = "00000000"
  я.п = []
  я.р = []
  перебрати 0..128 як х
    перебрати 0..7 як х1
      я.п.додати("0")
    кінець
  кінець
  перебрати 0..15 як х
    перебрати 0..7 як х1
      я.р.додати("0")
    кінець
  кінець
кінець

дія ЦП.завантажити(вхід)
  д_в = вхід.довжина - 1
  перебрати 0..д_в як х
    я.п[х] = вхід[х]
  кінець
кінець

дія ЦП.оновити()
  я.ін = алм_8біт(я.ін,"00000001","11")
кінець

дія ЦП.вр(інд)
  інд = інд * 8
  рез = ""
  перебрати 0..7 як х
    рез = рез + я.р[інд+х]
  кінець
  вернути рез
кінець

дія ЦП.пр(інд,вхід)
  інд = інд * 8
  перебрати 0..7 як х
    я.р[інд+х] = вхід[х]
  кінець
кінець

дія ЦП.вп(адр)
  адр = адр * 8
  рез = ""
  перебрати 0..7 як х
    рез = рез + я.п[адр+х]
  кінець
  вернути рез
кінець

дія ЦП.виконати(вхід)
  вх = рб(вхід)
  якщо вх[1] == "0000"

  кінець
  якщо вх[1] == "0001"
    ін = б_д(вх[0])
    я.оновити()
    адр = б_д(я.ін)
    дані = я.вп(адр)
    я.пр(ін,дані)
  кінець
кінець

дія ЦП.запустити(час)
  перебрати 0..час як х
    адр = б_д(я.ін)
    ком = я.вп(адр)
  кінець
кінець

дія ЦП.інфо()
  я.ін = "00000000"
  друк("-------------------------")
  друк("-адреса---команда-")
  перебрати 0..15 як х
    друк(я.ін + " " + я.вп(х))
    я.оновити()
  кінець
  я.ін = "00000000"
  друк("-------------------------")
кінець

цп = ЦП()
цп.створити()
цп.завантажити("00000001000001110001000100000001")
цп.запустити(5)

цп.інфо()